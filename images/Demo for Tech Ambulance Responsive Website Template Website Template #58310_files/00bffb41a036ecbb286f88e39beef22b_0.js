function oSendpulsePush(){var d="http://www.templatemonster.com";var e="http://www.templatemonster.com";var a="https://templatemonstercom.sendpulse.com";var i=true;var c=true;var w="00bffb41a036ecbb286f88e39beef22b";var b="";var u="";var q="";var f="https://sendpulse.com:4434";var g="web.com.sendpulse.push";var n={};var v="";var s=null;var j=null;var o=null;var k={};var p=false;var l={ru:"запрашивает разрешение на:",en:"wants to:",ua:"запитує дозвіл на:"};var h={ru:"Показывать оповещения",en:"Show notifications",ua:"Показувати сповіщення"};var r={ru:"Разрешить",en:"Allow",ua:"Дозволити"};var t={ru:"Блокировать",en:"Block",ua:"Блокувати"};var m=false;this.start=function(){if(!oSpP.detectSite()){oSpP.log("Application allowed only for "+d);return false}if(oSpP.detectOs()=="iOS"){oSpP.log("Application can not work on iOS");return false}var x=oSpP.detectOs();if(!c){if((x=="iOS")||(x=="Android")){oSpP.log("Application disabled for your device");return false}}n=oSpP.detectBrowser();v=n.name.toLowerCase();if((v=="chrome")&&(parseFloat(n.version)<42)){oSpP.log("Application can not work with Crome browser version less then 42");return false}if((v=="firefox")&&(parseFloat(n.version)<44)){oSpP.log("Application can not work with Firefox browser version less then 44");return false}if((v=="firefox")&&(x=="Android")){oSpP.log("Application can not work with Firefox on Android");return false}if((v=="chrome")||(v=="firefox")){window.addEventListener("message",function(A){if(A.origin.toLowerCase()==a.toLowerCase()){if(A.data=="initend"){clearInterval(j)}else{if(A.data=="closeme"){o.close()}else{oSpP.storeSubscription(A.data)}}}},false);if(i){oSpP.getDbValue("SPIDs","SubscriptionId",function(A){if(A.target.result===undefined){oSpP.getDbValue("SPIDs","PromptClosed",function(C){if(C.target.result===undefined){oSpP.showPrompt()}else{var B=parseInt(C.target.result.value);B--;if(B==0){oSpP.deleteDbValue("SPIDs","PromptClosed");oSpP.showPrompt()}else{oSpP.putValueToDb("SPIDs",{type:"PromptClosed",value:B})}}})}})}else{var z=document.querySelectorAll(".sp_notify_prompt");for(var y=0;y<z.length;y++){z[y].addEventListener("click",function(){oSpP.showPopUp()})}}}else{if(v=="safari"){if(i){oSpP.startSubscription()}else{var z=document.querySelectorAll(".sp_notify_prompt");for(var y=0;y<z.length;y++){z[y].addEventListener("click",function(){oSpP.startSubscription()})}}}}};this.startSubscription=function(){switch(v){case"safari":if(oSpP.isSafariNotificationSupported()){var x=window.safari.pushNotification.permission(g);oSpP.checkSafariPermission(x)}break}};this.checkCookie=function(y){for(var A=y+"=",z=document.cookie.split(";"),B=0;B<z.length;B++){for(var x=z[B];" "==x.charAt(0);){x=x.substring(1)}if(0==x.indexOf(A)){return x.substring(A.length,x.length)}}return""};this.checkSafariPermission=function(x){oSpP.log("[DD] Permissions: "+x.permission);if(x.permission==="default"){m=true;oSpP.getDbValue("SPIDs","PromptShowed",function(y){if(y.target.result===undefined){oSpP.sendPromptStat("prompt_showed");oSpP.putValueToDb("SPIDs",{type:"PromptShowed",value:1})}else{oSpP.sendPromptStat("prompt_showed_again")}});window.safari.pushNotification.requestPermission(f,g,{appkey:w},oSpP.checkSafariPermission)}else{if(x.permission==="denied"){if(m){oSpP.sendPromptStat("prompt_denied")}}else{if(x.permission==="granted"){if(m){oSpP.sendPromptStat("prompt_granted")}oSpP.subscribe()}}}};this.subscribe=function(){switch(v){case"safari":var y=window.safari.pushNotification.permission(g);if(y.permission==="granted"){var x=y.deviceToken;oSpP.checkLocalSubsctoption(x)}break}};this.checkLocalSubsctoption=function(x){oSpP.log("[DD] subscribe :: subscriptionId: "+x);oSpP.getDbValue("SPIDs","SubscriptionId",function(y){if(y.target.result===undefined){oSpP.sendSubscribeDataToServer(x,"subscribe");oSpP.putValueToDb("SPIDs",{type:"SubscriptionId",value:x})}else{if(y.target.result.value!==x){oSpP.sendSubscribeDataToServer(y.target.result.value,"unsubscribe");oSpP.sendSubscribeDataToServer(x,"subscribe");oSpP.putValueToDb("SPIDs",{type:"SubscriptionId",value:x})}}})};this.sendSubscribeDataToServer=function(x,B,y){var z=new XMLHttpRequest();z.open("POST",f,true);z.setRequestHeader("Content-Type","application/json");if(y===undefined){y={};y.uname=oSpP.checkCookie("lgn");y.os=oSpP.detectOs()}var A=new XMLHttpRequest();A.onreadystatechange=function(){if(A.readyState==4){if(A.status==200){y.ip=A.responseText.replace("\n","")}else{y.ip=""}y.variables=oSpP.getUserVariables();var C=window.location.href;var D={action:"subscription",subscriptionId:x,subscription_action:B,appkey:w,browser:n,lang:oSpP.getBrowserlanguage(),url:C,custom_data:y};z.send(JSON.stringify(D))}};A.open("GET",f+"/getip",true);A.send()};this.isSafariNotificationSupported=function(){return"safari" in window&&"pushNotification" in window.safari};this.storeSubscription=function(x){oSpP.log("StoreSubscription: "+x);oSpP.putValueToDb("SPIDs",{type:"SubscriptionId",value:x})};this.clearDomain=function(x){return x.replace("://www.","://").replace("://www2.","://")};this.detectSite=function(){return(!(oSpP.clearDomain(window.location.href.toLowerCase()).indexOf(oSpP.clearDomain(d.toLowerCase()))===-1))};this.getBrowserlanguage=function(){return navigator.language.substring(0,2)};this.getUserVariables=function(){var y={};var x=document.querySelectorAll("input.sp_push_custom_data");for(var z=0;z<x.length;z++){switch(x[z].type){case"text":case"hidden":y[x[z].name]=x[z].value;break;case"checkbox":y[x[z].name]=(x[z].checked)?1:0;break;case"radio":if(x[z].checked){y[x[z].name]=x[z].value}break}}return y};this.showPopUp=function(){if(i){oSpP.sendPromptStat("prompt_granted")}else{}var E=580;var A=580;var C=window.screenLeft!==undefined?window.screenLeft:screen.left;var x=window.screenTop!==undefined?window.screenTop:screen.top;var y=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width;var F=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height;var z=((y/2)-(E/2))+C;var D=((F/3)-(F/3))+x;var B=oSpP.getBrowserlanguage();if(B==""){B="en"}o=window.open(a+"/"+B+"/"+w,"_blank","scrollbars=yes, width="+E+", height="+A+", top="+D+", left="+z);if(window.focus){o.focus()}j=setInterval(function(){o.postMessage("init",a);o.postMessage("initpage|"+window.location.href,a);o.postMessage("initvariables|"+JSON.stringify(oSpP.getUserVariables()),a)},100);if(i){oSpP.closePrompt(true)}};this.showPrompt=function(){oSpP.getDbValue("SPIDs","PromptShowed",function(P){if(P.target.result===undefined){oSpP.sendPromptStat("prompt_showed");oSpP.putValueToDb("SPIDs",{type:"PromptShowed",value:1})}else{oSpP.sendPromptStat("prompt_showed_again")}});var F=document.getElementsByTagName("head")[0];var B=document.createElement("link");B.rel="stylesheet";B.type="text/css";B.href="https://cdn.sendpulse.com/css/push/sendpulse-prompt.min.css";B.media="all";F.appendChild(B);var C=oSpP.getMessageLang(oSpP.getBrowserlanguage());var J;var H="sendpulse-popover";var K="display:none;";if(b.length>0){var z='<svg style="display: none;"><symbol id="sp_bell_icon"><path d="M139.165 51.42L103.39 15.558C43.412 61.202 3.74 132.185 0 212.402h50.174c3.742-66.41 37.877-124.636 88.99-160.98zM474.98 212.403h50.173c-3.742-80.217-43.413-151.2-103.586-196.845L385.704 51.42c51.398 36.346 85.533 94.572 89.275 160.982zm-49.388 12.582c0-77-53.39-141.463-125.424-158.487v-17.09c0-20.786-16.76-37.613-37.592-37.613s-37.592 16.827-37.592 37.614v17.09C152.95 83.52 99.56 148.004 99.56 224.983v137.918L49.408 413.01v25.076h426.336V413.01l-50.152-50.108V224.984zM262.576 513.358c3.523 0 6.76-.22 10.065-1.007 16.237-3.237 29.825-14.528 36.06-29.626 2.517-5.952 4.05-12.494 4.05-19.54H212.4c0 27.593 22.582 50.174 50.174 50.174z" /></symbol></svg>';J=JSON.parse(b);H=J.style;var E=document.createElement("div");E.setAttribute("class","sendpulse-prompt "+H);if(J.backgroundcolor.length>0){K=K+"background-color: "+J.backgroundcolor+";"}E.setAttribute("style",K);var N=document.createElement("div");N.setAttribute("class","sendpulse-prompt-message");var M=document.createElement("img");M.setAttribute("class","sendpulse-bell-icon");M.setAttribute("width","14");M.setAttribute("height","14");M.setAttribute("src","https://cdn.sendpulse.com/img/push/icon-ring.svg");if(H=="sendpulse-bar"){var G=document.createElement("div");G.setAttribute("class","sendpulse-prompt-info sendpulse-prompt-message-text");G.setAttribute("style","color: "+J.textcolor+" !important;");G.innerHTML+=q;var I=document.createElement("span");N.innerHTML+=z+'<svg viewBox="0 0 525.153 525.153" width="40" height="40" xmlns:xlink="http://www.w3.org/1999/xlink" class="sendpulse-bell-icon"><use class="sendpulse-bell-path" style="fill: '+J.textcolor+' !important;" xlink:href="#sp_bell_icon" x="0" y="0" />  </svg>'}else{if(H=="sendpulse-modal"||H=="sendpulse-safari"||H=="sendpulse-fab"){var G=document.createElement("div");G.setAttribute("class","sendpulse-prompt-title sendpulse-prompt-message-text");if(J.textcolor.length>0){G.setAttribute("style","color: "+J.textcolor+" !important;")}G.innerHTML=u;var I=document.createElement("div");I.setAttribute("class","sendpulse-prompt-info sendpulse-prompt-message-text");if(J.textcolor.length>0){I.setAttribute("style","color: "+J.textcolor+" !important;")}I.innerHTML+=q;if(H=="sendpulse-safari"){M.setAttribute("src","https://cdn.sendpulse.com"+J.icon);M.setAttribute("width","64");M.setAttribute("height","64");N.appendChild(M)}else{if(H!="sendpulse-fab"){N.innerHTML+=z+'<svg viewBox="0 0 525.153 525.153" width="40" height="40" xmlns:xlink="http://www.w3.org/1999/xlink" class="sendpulse-bell-icon"><use class="sendpulse-bell-path" style="fill: '+J.textcolor+' !important;" xlink:href="#sp_bell_icon" x="0" y="0" />  </svg>'}}if(H=="sendpulse-fab"){var L=document.createElement("div");L.setAttribute("class","sendpulse-prompt-fab");if(J.btncolor.length>0){L.setAttribute("style","background-color: "+J.btncolor+" !important;")}L.innerHTML+=z+'<svg viewBox="0 0 525.153 525.153" width="40" height="40" xmlns:xlink="http://www.w3.org/1999/xlink" class="sendpulse-bell-icon" ><use class="sendpulse-bell-path bell-prompt-fab" style="fill: '+J.iconcolor+' !important;" xlink:href="#sp_bell_icon" x="0" y="0" /></svg>';L.setAttribute("onclick","oSpP.showPopUp(); return false;")}}}}else{var E=document.createElement("div");E.setAttribute("class","sendpulse-prompt "+H);E.setAttribute("style",K);var N=document.createElement("div");N.setAttribute("class","sendpulse-prompt-message");var G=document.createElement("div");G.setAttribute("class","sendpulse-prompt-message-text");G.innerHTML=e+" "+l[C];var I=document.createElement("div");I.setAttribute("class","sendpulse-prompt-info sendpulse-prompt-message-text");var M=document.createElement("img");M.setAttribute("class","sendpulse-bell-icon");M.setAttribute("width","14");M.setAttribute("height","14");M.setAttribute("src","https://cdn.sendpulse.com/img/push/icon-ring.svg");I.appendChild(M);I.innerHTML+=" "+h[C]}if(H!="sendpulse-fab"){var x=document.createElement("div");x.setAttribute("class","sendpulse-prompt-buttons");var O=document.createElement("button");O.setAttribute("class","sendpulse-prompt-btn sendpulse-accept-btn");O.setAttribute("type","button");O.setAttribute("onclick","oSpP.showPopUp(); return false;");O.innerHTML=r[C];var A=document.createElement("button");A.setAttribute("class","sendpulse-prompt-btn sendpulse-disallow-btn");A.setAttribute("type","button");A.setAttribute("onclick","oSpP.denyMessage(); return false;");A.innerHTML=t[C];if(H!="sendpulse-popover"){O.innerHTML=J.allowbtntext;A.innerHTML=J.disallowbtntext;if(H!="sendpulse-safari"){O.setAttribute("style","background-color:"+J.buttoncolor+" !important;border-color:"+J.buttoncolor+" !important;");A.setAttribute("style","color:"+J.buttoncolor+" !important;")}}x.appendChild(A);x.appendChild(O)}N.appendChild(G);N.appendChild(I);if(H!="sendpulse-fab"){N.appendChild(x);E.appendChild(N)}else{E.appendChild(N);E.appendChild(L)}if(H!="sendpulse-popover"&&H!="sendpulse-safari"&&H!="sendpulse-fab"){var y=document.createElement("button");y.setAttribute("class","sendpulse-prompt-close");y.setAttribute("onclick","oSpP.closePrompt(); return false;");y.setAttribute("style","color:"+J.textcolor+" !important;");y.innerHTML="&times;";E.appendChild(y)}document.body.insertBefore(E,document.body.childNodes[0]);if(H=="sendpulse-modal"){var D=document.createElement("div");D.setAttribute("class","sendpulse-prompt-backdrop");D.setAttribute("style","display:none;");document.body.insertBefore(D,document.body.childNodes[1])}setTimeout(function(){E.className+=E.className?" show-prompt":"show-prompt"},1000)};this.denyMessage=function(){oSpP.sendPromptStat("prompt_denied");oSpP.storeSubscription("DENY");oSpP.closePrompt(true)};this.closePrompt=function(x){if(x===undefined){oSpP.sendPromptStat("prompt_closed")}document.body.removeChild(document.querySelector(".sendpulse-prompt"));if(document.getElementsByClassName("sendpulse-prompt-backdrop").length>0){document.body.removeChild(document.querySelector(".sendpulse-prompt-backdrop"))}oSpP.putValueToDb("SPIDs",{type:"PromptClosed",value:5})};this.initDb=function(z){if(s){return void z()}var y=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB;var x=y.open("sendpulse_push_db",2);x.onsuccess=function(A){s=A.target.result;z()};x.onupgradeneeded=function(A){var B=A.target.result;B.createObjectStore("SPIDs",{keyPath:"type"})}};this.getDbValue=function(x,y,z){oSpP.initDb(function(){s.transaction([x],"readonly").objectStore(x).get(y).onsuccess=z})};this.putValueToDb=function(x,y){oSpP.initDb(function(){s.transaction([x],"readwrite").objectStore(x).put(y)})};this.deleteDbValue=function(x,y){oSpP.initDb(function(){s.transaction([x],"readwrite").objectStore(x)["delete"](y)})};this.log=function(x){};this.detectBrowser=function(){var z,y=navigator.userAgent,x=y.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];var A=y.match(/(edge(?=\/))\/?\s*(\d+)/i)||[];if("Edge"===A[1]){return{name:A[1],version:A[2]}}return/trident/i.test(x[1])?(z=/\brv[ :]+(\d+)/g.exec(y)||[],{name:"IE",version:z[1]||""}):"Chrome"===x[1]&&(z=y.match(/\bOPR\/(\d+)/),null!=z)?{name:"Opera",version:z[1]}:(x=x[2]?[x[1],x[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(z=y.match(/version\/(\d+)/i))&&x.splice(1,1,z[1]),{name:x[0],version:x[1]})};this.detectOs=function(){var x="";if(navigator.userAgent.indexOf("Windows")!=-1){return("Windows")}if(navigator.userAgent.indexOf("Android")!=-1){return("Android")}if(navigator.userAgent.indexOf("Linux")!=-1){return("Linux")}if(navigator.userAgent.indexOf("iPhone")!=-1){return("iOS")}if(navigator.userAgent.indexOf("Mac")!=-1){return("Mac OS")}if(navigator.userAgent.indexOf("FreeBSD")!=-1){return("FreeBSD")}return""};this.uns=function(){oSpP.deleteDbValue("SPIDs","SubscriptionId")};this.getMessageLang=function(x){x=x.substring(0,2).toLowerCase();if(x=="ua"||x=="uk"){return"ua"}else{if(x=="ru"){return"ru"}else{return"en"}}};this.push=function(x,y){if(!oSpP.detectSite()){oSpP.log("Application allowed only for "+d);return false}k[x]=y;oSpP.getDbValue("SPIDs","SubscriptionId",function(z){if(z.target.result===undefined){if(!p){p=setInterval(function(){oSpP.getDbValue("SPIDs","SubscriptionId",function(A){if(A.target.result!==undefined){oSpP.sendUpdatesToServer(A.target.result.value);clearInterval(p);p=false}})},1000)}}else{oSpP.sendUpdatesToServer(z.target.result.value)}})};this.sendUpdatesToServer=function(x){var z=new XMLHttpRequest();z.open("POST",f,true);z.setRequestHeader("Content-Type","application/json");var y={action:"subscription",subscriptionId:x,subscription_action:"update_variables",appkey:w,custom_data:{variables:k}};z.send(JSON.stringify(y))};this.sendPromptStat=function(z){oSpP.log("[DD] Send prompt stat: "+z);var y=new XMLHttpRequest();y.open("POST",f,true);y.setRequestHeader("Content-Type","application/json");var x={action:"statisctic",statisctic_action:z,appkey:w};y.send(JSON.stringify(x))}}window.addEventListener("load",function(){oSpP.start()});var oSpP=new oSendpulsePush();